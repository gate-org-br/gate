package gate.util;

import java.lang.reflect.AnnotatedElement;
import java.util.ArrayList;
import java.util.List;
import java.util.Objects;
import java.util.logging.Level;
import java.util.logging.Logger;

public class Icons
{

	public static final Icon UNKNOWN
		= new Icon("?", "??????");

	private final List<Icon> icons;

	private static Icons instance;

	public static Icons getInstance()
	{
		if (instance == null)
			instance = new Icons();
		return instance;
	}

	private Icons()
	{
		icons = new ArrayList<>();
		icons.add(new Icon("1000", "commit"));
		icons.add(new Icon("1001", "cancel"));
		icons.add(new Icon("1002", "insert"));
		icons.add(new Icon("1003", "??????"));
		icons.add(new Icon("1006", "??????"));
		icons.add(new Icon("1007", "??????"));
		icons.add(new Icon("1010", "??????"));
		icons.add(new Icon("1011", "??????"));
		icons.add(new Icon("1012", "??????"));
		icons.add(new Icon("1013", "??????"));
		icons.add(new Icon("1014", "??????"));
		icons.add(new Icon("1020", "??????"));
		icons.add(new Icon("1021", "??????"));
		icons.add(new Icon("1022", "??????"));
		icons.add(new Icon("1023", "??????"));
		icons.add(new Icon("1024", "??????"));
		icons.add(new Icon("2000", "closed"));
		icons.add(new Icon("2001", "opened"));
		icons.add(new Icon("2002", "passwd"));
		icons.add(new Icon("2003", "date"));
		icons.add(new Icon("2004", "person"));
		icons.add(new Icon("2005", "people"));
		icons.add(new Icon("2006", "??????"));
		icons.add(new Icon("2007", "??????"));
		icons.add(new Icon("2008", "home"));
		icons.add(new Icon("2009", "??????"));
		icons.add(new Icon("200A", "??????"));
		icons.add(new Icon("2010", "search"));
		icons.add(new Icon("2011", "??????"));
		icons.add(new Icon("2012", "??????"));
		icons.add(new Icon("2013", "tag"));
		icons.add(new Icon("2014", "tags"));
		icons.add(new Icon("2015", "??????"));
		icons.add(new Icon("2016", "??????"));
		icons.add(new Icon("2017", "??????"));
		icons.add(new Icon("2018", "??????"));
		icons.add(new Icon("2019", "??????"));
		icons.add(new Icon("2020", "??????"));
		icons.add(new Icon("2021", "report"));
		icons.add(new Icon("2022", "filter"));
		icons.add(new Icon("2023", "return"));
		icons.add(new Icon("2024", "??????"));
		icons.add(new Icon("2025", "??????"));
		icons.add(new Icon("2026", "delete"));
		icons.add(new Icon("2027", "??????"));
		icons.add(new Icon("2030", "??????"));
		icons.add(new Icon("2031", "pchart"));
		icons.add(new Icon("2032", "lchart"));
		icons.add(new Icon("2033", "cchart"));
		icons.add(new Icon("2034", "??????"));
		icons.add(new Icon("2035", "dwload"));
		icons.add(new Icon("2036", "upload"));
		icons.add(new Icon("2037", "??????"));
		icons.add(new Icon("2038", "??????"));
		icons.add(new Icon("2039", "??????"));
		icons.add(new Icon("2040", "??????"));
		icons.add(new Icon("2041", "??????"));
		icons.add(new Icon("2042", "??????"));
		icons.add(new Icon("2043", "??????"));
		icons.add(new Icon("2044", "??????"));
		icons.add(new Icon("2045", "??????"));
		icons.add(new Icon("2046", "??????"));
		icons.add(new Icon("2047", "??????"));
		icons.add(new Icon("2048", "??????"));
		icons.add(new Icon("2049", "??????"));
		icons.add(new Icon("2050", "??????"));
		icons.add(new Icon("2051", "??????"));
		icons.add(new Icon("2052", "??????"));
		icons.add(new Icon("2053", "??????"));
		icons.add(new Icon("2054", "??????"));
		icons.add(new Icon("2055", "select"));
		icons.add(new Icon("2056", "??????"));
		icons.add(new Icon("2057", "update"));
		icons.add(new Icon("2058", "??????"));
		icons.add(new Icon("2059", "client"));
		icons.add(new Icon("2070", "??????"));
		icons.add(new Icon("2071", "??????"));
		icons.add(new Icon("2072", "??????"));
		icons.add(new Icon("2073", "??????"));
		icons.add(new Icon("2074", "??????"));
		icons.add(new Icon("2075", "??????"));
		icons.add(new Icon("2076", "??????"));
		icons.add(new Icon("2077", "enter"));
		icons.add(new Icon("2078", "leave"));
		icons.add(new Icon("2079", "attach"));
		icons.add(new Icon("2080", "??????"));
		icons.add(new Icon("2081", "??????"));
		icons.add(new Icon("2082", "??????"));
		icons.add(new Icon("2083", "??????"));
		icons.add(new Icon("2084", "??????"));
		icons.add(new Icon("2085", "??????"));
		icons.add(new Icon("2086", "??????"));
		icons.add(new Icon("2087", "??????"));
		icons.add(new Icon("2088", "??????"));
		icons.add(new Icon("2089", "??????"));
		icons.add(new Icon("2090", "??????"));
		icons.add(new Icon("2091", "??????"));
		icons.add(new Icon("2092", "??????"));
		icons.add(new Icon("2093", "??????"));
		icons.add(new Icon("2094", "??????"));
		icons.add(new Icon("2095", "??????"));
		icons.add(new Icon("2096", "??????"));
		icons.add(new Icon("2097", "??????"));
		icons.add(new Icon("2098", "??????"));
		icons.add(new Icon("2099", "??????"));
		icons.add(new Icon("2100", "??????"));
		icons.add(new Icon("2101", "trophy"));
		icons.add(new Icon("2102", "??????"));
		icons.add(new Icon("2103", "??????"));
		icons.add(new Icon("2104", "??????"));
		icons.add(new Icon("2105", "??????"));
		icons.add(new Icon("2106", "??????"));
		icons.add(new Icon("2107", "??????"));
		icons.add(new Icon("2108", "??????"));
		icons.add(new Icon("2109", "??????"));
		icons.add(new Icon("2110", "??????"));
		icons.add(new Icon("2111", "??????"));
		icons.add(new Icon("2112", "??????"));
		icons.add(new Icon("2113", "??????"));
		icons.add(new Icon("2114", "??????"));
		icons.add(new Icon("2115", "??????"));
		icons.add(new Icon("2116", "??????"));
		icons.add(new Icon("2117", "??????"));
		icons.add(new Icon("2118", "??????"));
		icons.add(new Icon("2119", "??????"));
		icons.add(new Icon("2120", "??????"));
		icons.add(new Icon("2121", "??????"));
		icons.add(new Icon("2122", "??????"));
		icons.add(new Icon("2123", "??????"));
		icons.add(new Icon("2124", "??????"));
		icons.add(new Icon("2125", "??????"));
		icons.add(new Icon("2126", "??????"));
		icons.add(new Icon("2127", "??????"));
		icons.add(new Icon("2128", "??????"));
		icons.add(new Icon("2129", "??????"));
		icons.add(new Icon("2130", "??????"));
		icons.add(new Icon("2131", "??????"));
		icons.add(new Icon("2132", "??????"));
		icons.add(new Icon("2133", "??????"));
		icons.add(new Icon("2134", "??????"));
		icons.add(new Icon("2135", "??????"));
		icons.add(new Icon("2136", "??????"));
		icons.add(new Icon("2137", "??????"));
		icons.add(new Icon("2138", "??????"));
		icons.add(new Icon("2139", "??????"));
		icons.add(new Icon("2140", "??????"));
		icons.add(new Icon("2141", "??????"));
		icons.add(new Icon("2142", "??????"));
		icons.add(new Icon("2143", "??????"));
		icons.add(new Icon("2144", "??????"));
		icons.add(new Icon("2145", "??????"));
		icons.add(new Icon("2146", "??????"));
		icons.add(new Icon("2147", "??????"));
		icons.add(new Icon("2148", "??????"));
		icons.add(new Icon("2149", "??????"));
		icons.add(new Icon("2150", "??????"));
		icons.add(new Icon("2151", "??????"));
		icons.add(new Icon("2152", "??????"));
		icons.add(new Icon("2153", "??????"));
		icons.add(new Icon("2154", "??????"));
		icons.add(new Icon("2155", "??????"));
		icons.add(new Icon("2156", "??????"));
		icons.add(new Icon("2157", "??????"));
		icons.add(new Icon("2158", "??????"));
		icons.add(new Icon("2159", "??????"));
		icons.add(new Icon("2160", "??????"));
		icons.add(new Icon("2161", "??????"));
		icons.add(new Icon("2162", "??????"));
		icons.add(new Icon("2163", "??????"));
		icons.add(new Icon("2164", "??????"));
		icons.add(new Icon("2165", "??????"));
		icons.add(new Icon("2166", "??????"));
		icons.add(new Icon("2167", "time"));
		icons.add(new Icon("2168", "??????"));
		icons.add(new Icon("2169", "??????"));
		icons.add(new Icon("2170", "??????"));
		icons.add(new Icon("2171", "??????"));
		icons.add(new Icon("2172", "??????"));
		icons.add(new Icon("2173", "??????"));
		icons.add(new Icon("2174", "??????"));
		icons.add(new Icon("2175", "??????"));
		icons.add(new Icon("2176", "??????"));
		icons.add(new Icon("2177", "??????"));
		icons.add(new Icon("2178", "??????"));
		icons.add(new Icon("2179", "??????"));
		icons.add(new Icon("2180", "??????"));
		icons.add(new Icon("2181", "??????"));
		icons.add(new Icon("2182", "??????"));
		icons.add(new Icon("2183", "??????"));
		icons.add(new Icon("2187", "??????"));
		icons.add(new Icon("2188", "??????"));
		icons.add(new Icon("2189", "prompt"));
		icons.add(new Icon("2190", "??????"));
		icons.add(new Icon("2191", "??????"));
		icons.add(new Icon("2192", "??????"));
		icons.add(new Icon("2193", "??????"));
		icons.add(new Icon("2194", "??????"));
		icons.add(new Icon("2195", "??????"));
		icons.add(new Icon("2196", "??????"));
		icons.add(new Icon("2197", "??????"));
		icons.add(new Icon("2198", "??????"));
		icons.add(new Icon("2199", "??????"));
		icons.add(new Icon("2200", "??????"));
		icons.add(new Icon("2201", "??????"));
		icons.add(new Icon("2202", "??????"));
		icons.add(new Icon("2203", "??????"));
		icons.add(new Icon("2204", "??????"));
		icons.add(new Icon("2205", "??????"));
		icons.add(new Icon("2206", "??????"));
		icons.add(new Icon("2207", "??????"));
		icons.add(new Icon("2208", "??????"));
		icons.add(new Icon("2209", "??????"));
		icons.add(new Icon("2210", "??????"));
		icons.add(new Icon("2211", "??????"));
		icons.add(new Icon("2212", "??????"));
		icons.add(new Icon("2213", "??????"));
		icons.add(new Icon("2214", "??????"));
		icons.add(new Icon("2215", "??????"));
		icons.add(new Icon("2216", "??????"));
		icons.add(new Icon("2217", "??????"));
		icons.add(new Icon("2218", "pdf"));
		icons.add(new Icon("2219", "odt"));
		icons.add(new Icon("2220", "doc"));
		icons.add(new Icon("2221", "xls"));
		icons.add(new Icon("2222", "csv"));
		icons.add(new Icon("2223", "??????"));
		icons.add(new Icon("2224", "??????"));
		icons.add(new Icon("2225", "??????"));
		icons.add(new Icon("2226", "??????"));
		icons.add(new Icon("2227", "??????"));
		icons.add(new Icon("2228", "??????"));
		icons.add(new Icon("2229", "??????"));
		icons.add(new Icon("2230", "??????"));
		icons.add(new Icon("2231", "??????"));
		icons.add(new Icon("2232", "??????"));
		icons.add(new Icon("2233", "??????"));
		icons.add(new Icon("2234", "??????"));
		icons.add(new Icon("2235", "??????"));
		icons.add(new Icon("2236", "??????"));
		icons.add(new Icon("2237", "??????"));
		icons.add(new Icon("2238", "??????"));
		icons.add(new Icon("2239", "??????"));
		icons.add(new Icon("2240", "??????"));
		icons.add(new Icon("2241", "??????"));
		icons.add(new Icon("2242", "??????"));
		icons.add(new Icon("2243", "??????"));
		icons.add(new Icon("2244", "achart"));
		icons.add(new Icon("2245", "dchart"));
		icons.add(new Icon("2246", "bchart"));
		icons.add(new Icon("2247", "rchart"));
		icons.add(new Icon("2248", "??????"));
		icons.add(new Icon("2249", "??????"));
		icons.add(new Icon("2250", "??????"));
		icons.add(new Icon("2251", "??????"));
		icons.add(new Icon("2252", "??????"));
		icons.add(new Icon("2253", "??????"));
		icons.add(new Icon("2254", "??????"));
		icons.add(new Icon("2255", "??????"));
		icons.add(new Icon("2256", "dialog"));
		icons.add(new Icon("2257", "??????"));
		icons.add(new Icon("2258", "??????"));
		icons.add(new Icon("2259", "??????"));
		icons.add(new Icon("2260", "??????"));
		icons.add(new Icon("2261", "island"));
		icons.add(new Icon("2262", "??????"));
		icons.add(new Icon("2263", "??????"));
		icons.add(new Icon("2264", "??????"));
		icons.add(new Icon("2265", "??????"));
		icons.add(new Icon("2266", "??????"));
		icons.add(new Icon("2267", "??????"));
		icons.add(new Icon("2268", "??????"));
		icons.add(new Icon("2269", "??????"));
		icons.add(new Icon("2270", "??????"));
		icons.add(new Icon("2271", "??????"));
		icons.add(new Icon("2272", "??????"));
		icons.add(new Icon("2273", "??????"));
		icons.add(new Icon("2274", "??????"));
		icons.add(new Icon("2275", "??????"));
		icons.add(new Icon("2276", "??????"));
		icons.add(new Icon("2277", "??????"));
		icons.add(new Icon("2278", "??????"));
		icons.add(new Icon("2279", "??????"));
		icons.add(new Icon("2280", "??????"));
		icons.add(new Icon("2281", "??????"));
		icons.add(new Icon("2282", "??????"));
		icons.add(new Icon("2283", "??????"));
	}

	public Icon[] get()
	{
		return icons.toArray(new Icon[icons.size()]);
	}

	public Icon get(Object type)
	{
		try
		{
			if (type instanceof String)
			{
				String string = (String) type;

				if (string.length() == 1)
					return new Icon((String) type, "??????");

				for (Icon icon : icons)
					if (icon.getName().equals(string))
						return icon;

				for (Icon icon : icons)
					if (icon.getCode().equals(string))
						return icon;

				if (string.contains(":"))
				{
					String[] strings = string.split(":");

					if (strings[1].endsWith("()"))
						return getIcon(Class.forName(strings[0]).getMethod(strings[1].substring(0, strings[1].length() - 2)));

					return getIcon(Class.forName(strings[0]).getField(strings[1]));
				}

				return getIcon(Class.forName((String) type));
			}

			if (type instanceof Enum<?>)
				return getIcon(type.getClass().getField(((Enum<?>) type).name()));

			if (type instanceof AnnotatedElement)
				return getIcon((AnnotatedElement) type);

			if (type instanceof Object)
				return getIcon(type.getClass());
		} catch (ClassNotFoundException
			| NoSuchFieldException
			| NoSuchMethodException
			| SecurityException ex)
		{
			Logger.getGlobal().log(Level.SEVERE, "Error loading icon", ex);
		}

		return UNKNOWN;
	}

	private Icon getIcon(AnnotatedElement annotatedElement)
	{
		return annotatedElement.isAnnotationPresent(gate.annotation.Icon.class)
			? get(annotatedElement.getAnnotation(gate.annotation.Icon.class).value())
			: UNKNOWN;
	}

	public static class Icon
	{

		private final String code;
		private final String name;

		public Icon(String code, String name)
		{
			this.code = code;
			this.name = name;
		}

		public String getCode()
		{
			return code;
		}

		public String getName()
		{
			return name;
		}

		@Override
		public boolean equals(Object obj)
		{
			return obj instanceof Icon
				&& Objects.equals(code, ((Icon) obj).code)
				&& Objects.equals(name, ((Icon) obj).name);

		}

		@Override
		public int hashCode()
		{
			return Objects.hashCode(code)
				+ Objects.hashCode(name);
		}

		@Override
		public String toString()
		{
			return "&#X" + getCode() + ";";
		}
	}
}
